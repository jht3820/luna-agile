<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="prj1100DAO">
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>

	
	<sql id="selectPrj1100List">
		<![CDATA[
			SELECT
				ROWNUM RN,
				SUBT1.LIC_GRP_ID,
				SUBT1.PRJ_GRP_ID,
				SUBT1.PRJ_ID,
				SUBT1.PRJ_NM,
				SUBT1.PROCESS_ID,
				SUBT1.PROCESS_NM,
				SUBT1.PROCESS_DESC,
				SUBT1.PROCESS_TRANSFER_CD,
				SF_STM4001_COM_CD_INFO(SUBT1.LIC_GRP_ID, 'CMM00005', SUBT1.PROCESS_TRANSFER_CD, '1') AS PROCESS_TRANSFER_NM,
				SUBT1.PROCESS_DISABLED_CD,
				SF_STM4001_COM_CD_INFO(SUBT1.LIC_GRP_ID, 'FLW00006', SUBT1.PROCESS_DISABLED_CD, '1') AS PROCESS_DISABLED_NM,
				SUBT1.USE_CD,
				SUBT1.DEL_CD,
				SUBT1.PROCESS_ORD,
				SUBT1.REQ_CNT,
				SUBT1.REG_DTM,
				SUBT1.REG_USR_ID,
				SUBT1.REG_USR_IP,
				SUBT1.MODIFY_DTM,
				SUBT1.MODIFY_USR_ID,
				SUBT1.MODIFY_USR_IP
			FROM
			(
				SELECT
					B.LIC_GRP_ID,
					B.PRJ_GRP_ID,
					A.PRJ_ID,
					B.PRJ_NM,
					A.PROCESS_ID,
					A.PROCESS_NM,
					A.PROCESS_DESC,
					A.PROCESS_TRANSFER_CD,
					A.PROCESS_DISABLED_CD,
					A.USE_CD,
					A.DEL_CD,
					A.PROCESS_ORD,
					(SELECT COUNT(*) FROM REQ4100 Z WHERE Z.PRJ_ID = A.PRJ_ID AND Z.PROCESS_ID = A.PROCESS_ID) AS REQ_CNT,
					TO_CHAR(A.REG_DTM, 'YYYY-MM-DD HH24:MI') AS REG_DTM,
					A.REG_USR_ID,
					A.REG_USR_IP,
					TO_CHAR(A.MODIFY_DTM, 'YYYY-MM-DD HH24:MI') AS MODIFY_DTM,
					A.MODIFY_USR_ID,
					A.MODIFY_USR_IP
				FROM PRJ1100 A
				INNER JOIN PRJ1000 B ON (A.PRJ_ID = B.PRJ_ID AND B.LIC_GRP_ID = #licGrpId# AND B.USE_CD = '01' AND B.DEL_CD = '02')
				WHERE 1=1
				]]>
				<isNotEmpty property="prjId">
					AND A.PRJ_ID = #prjId#
				</isNotEmpty>
				<isNotEmpty property="useCd">
					AND A.USE_CD = #useCd#
				</isNotEmpty>
				<isNotEmpty property="delCd">
					AND A.DEL_CD = #delCd#
				</isNotEmpty>
				<isNotEmpty property="processTransferCd">
					AND A.PROCESS_TRANSFER_CD = #processTransferCd#
				</isNotEmpty>
				<isNotEmpty property="processDisabledCd">
					AND A.PROCESS_DISABLED_CD = #processDisabledCd#
				</isNotEmpty>
				<isNotEmpty property="paramSortFieldId">
					<isNotEmpty property="sortDirection">
						ORDER BY $paramSortFieldId$
						<isEqual property="sortDirection" compareValue="desc">
							DESC
						</isEqual>
						<isEqual property="sortDirection" compareValue="asc">
							ASC
						</isEqual>
					</isNotEmpty>
				</isNotEmpty>
				<isEmpty property="paramSortFieldId">
					ORDER BY A.PROCESS_ORD, A.PROCESS_NM, A.REG_DTM DESC
				</isEmpty> 
				<![CDATA[
			) SUBT1
			WHERE 1=1
		]]>
			<isNotEmpty property="searchTargetData">
				<isNotEmpty property="searchTargetId">
					<isEqual property="searchTargetId" compareValue="processNm">
						AND	SUBT1.PROCESS_NM LIKE '%'|| #searchTargetData# ||'%'
					</isEqual>
					<isEqual property="searchTargetId" compareValue="processId">
						AND	SUBT1.PROCESS_ID = #searchTargetData#
					</isEqual>
				</isNotEmpty>
			</isNotEmpty>
	</sql>
	
	
	<sql id="selectPrj1100ProcessAuthUsrList">
		SELECT
			ROWNUM RN,
			SUBT2.AUTH_TYPE_CD,
			SUBT2.AUTH_TYPE_NM,
			SUBT2.LIC_GRP_ID,
			SUBT2.PRJ_ID,
			SUBT2.PROCESS_ID,
			SUBT2.USR_ID,
			SUBT2.USR_NM,
			SUBT2.EMAIL,
			SUBT2.TELNO,
			SUBT2.USR_IMG_ID,
			SUBT2.DEPT_ID,
			SUBT2.DEPT_NAME,
			SUBT2.USR_POSITION_CD,
			NVL(SF_STM4001_COM_CD_INFO(#licGrpId#, 'ADM00007', SUBT2.USR_POSITION_CD, '1'), '-') AS USR_POSITION_NM,
			SUBT2.USR_DUTY_CD,
			NVL(SF_STM4001_COM_CD_INFO(#licGrpId#, 'ADM00008', SUBT2.USR_DUTY_CD, '1'), '-') AS USR_DUTY_NM
		FROM
		(
			SELECT SUBT1.*,
					SF_STM4001_COM_CD_INFO(#licGrpId#, 'PRJ00018', SUBT1.AUTH_TYPE_CD, '1') AS AUTH_TYPE_NM
			FROM
			(
				SELECT
					'01' AS AUTH_TYPE_CD,
					B.LIC_GRP_ID,
					A.PRJ_ID,
					A.PROCESS_ID,
					A.PROCESS_AUTH_TYPE_CD,
					A.PROCESS_AUTH_TARGET_ID AS USR_ID,
					B.USR_NM,
					B.EMAIL,
					B.TELNO,
					B.USR_IMG_ID,
					B.DEPT_ID,
					SF_STM6000_DEPT_NM(#licGrpId#, B.DEPT_ID, '2') AS DEPT_NAME,
					B.USR_POSITION_CD,
					B.USR_DUTY_CD
				FROM PRJ1106 A
				INNER JOIN STM3000 B ON ( B.LIC_GRP_ID = #licGrpId# AND B.USR_ID = A.PROCESS_AUTH_TARGET_ID )
				WHERE 1=1
					AND A.PRJ_ID = #prjId#
					AND	A.PROCESS_ID = #processId#
					AND B.DEL_CD = '02'
					AND B.USE_CD = '01'
					AND B.BLOCK = '01'
					AND A.PROCESS_AUTH_TYPE_CD = '01'
				UNION
				SELECT
					'02' AS AUTH_TYPE_CD,
					B.LIC_GRP_ID,
					A.PRJ_ID,
					A.PROCESS_ID,
					A.PROCESS_AUTH_TYPE_CD,
					A.PROCESS_AUTH_TARGET_ID AS USR_ID,
					B.AUTH_GRP_NM AS USR_NM,
					'' AS EMAIL,
					'' AS TELNO,
					'' AS USR_IMG_ID,
					'' AS DEPT_ID,
					'' AS DEPT_NM,
					'' AS USR_POSITION_CD,
					'' AS USR_DUTY_CD
				FROM PRJ1106 A
				INNER JOIN PRJ2000 B ON (  B.LIC_GRP_ID  = #licGrpId# AND A.PRJ_ID = B.PRJ_ID AND B.AUTH_GRP_ID = A.PROCESS_AUTH_TARGET_ID AND B.USE_CD = '01')
				WHERE 1=1
				AND A.PRJ_ID = #prjId#
				AND	A.PROCESS_ID = #processId#
				AND A.PROCESS_AUTH_TYPE_CD = '02'
			) SUBT1
			WHERE 1=1
			<isNotEmpty property="prjAuthTypeCd">
				AND		SUBT1.PROCESS_AUTH_TYPE_CD = #prjAuthTypeCd#
			</isNotEmpty>
			<isNotEmpty property="paramSortFieldId">
				<isNotEmpty property="sortDirection">
					ORDER BY $paramSortFieldId$
					<isEqual property="sortDirection" compareValue="desc">
						DESC
					</isEqual>
				</isNotEmpty>
			</isNotEmpty>
			<isEmpty property="paramSortFieldId">
				ORDER BY DECODE(SUBT1.AUTH_TYPE_CD, '02', 1, '01', 2), SUBT1.USR_NM, SUBT1.USR_POSITION_CD DESC, SUBT1.USR_DUTY_CD DESC
			</isEmpty>
		) SUBT2
		WHERE 1=1
		<isNotEmpty property="searchTargetData">
			<isNotEmpty property="searchTargetId">
				<isEqual property="searchTargetId" compareValue="usrPositionCd">
					AND	SUBT2.USR_POSITION_CD = #searchTargetData#
				</isEqual>
				<isEqual property="searchTargetId" compareValue="usrDutyCd">
					AND	SUBT2.USR_DUTY_CD = #searchTargetData#
				</isEqual>
				<isEqual property="searchTargetId" compareValue="usrId">
					AND	SUBT2.USR_ID = #searchTargetData#
				</isEqual>
				<isEqual property="searchTargetId" compareValue="usrNm">
					AND	SUBT2.USR_NM LIKE '%'|| #searchTargetData# ||'%'
				</isEqual>
				<isEqual property="searchTargetId" compareValue="deptName">
					AND	SUBT2.DEPT_NAME LIKE '%'|| #searchTargetData# ||'%'
				</isEqual>
			</isNotEmpty>
		</isNotEmpty>
	</sql>
	
	
	<sql id="selectPrj1100ProcessAuthNoneUsrList">
		SELECT
			ROWNUM RN,
			SUBT2.AUTH_TYPE_CD,
			SUBT2.AUTH_TYPE_NM,
			SUBT2.LIC_GRP_ID,
			SUBT2.USR_ID,
			SUBT2.USR_NM,
			SUBT2.EMAIL,
			SUBT2.TELNO,
			SUBT2.USR_IMG_ID,
			SUBT2.DEPT_ID,
			SUBT2.DEPT_NAME,
			SUBT2.USR_POSITION_CD,
			NVL(SF_STM4001_COM_CD_INFO(#licGrpId#, 'ADM00007', SUBT2.USR_POSITION_CD, '1'), '-') AS USR_POSITION_NM,
			SUBT2.USR_DUTY_CD,
			NVL(SF_STM4001_COM_CD_INFO(#licGrpId#, 'ADM00008', SUBT2.USR_DUTY_CD, '1'), '-') AS USR_DUTY_NM
		FROM
		(
			SELECT SUBT1.*,
			SF_STM4001_COM_CD_INFO(#licGrpId#, 'PRJ00018', SUBT1.AUTH_TYPE_CD, '1') AS AUTH_TYPE_NM
			FROM
			(
				SELECT 
					'01' AS AUTH_TYPE_CD,
					A.LIC_GRP_ID,
					A.USR_ID,
					A.USR_NM,
					A.EMAIL,
					A.TELNO,
					A.USR_IMG_ID,
					A.DEPT_ID,
					SF_STM6000_DEPT_NM(#licGrpId#, A.DEPT_ID, '2') AS DEPT_NAME,
					A.USR_POSITION_CD,
					A.USR_DUTY_CD
				FROM STM3000 A
				WHERE	1=1
	      			AND A.LIC_GRP_ID = #licGrpId#
					AND A.DEL_CD = '02'
					AND A.USE_CD = '01'
					AND A.BLOCK = '01'
					<!-- 
	        		AND	NOT EXISTS
	        		(
						SELECT	Z.PROCESS_AUTH_TARGET_ID
	                    FROM	PRJ1106 Z
	                    WHERE	1=1
	                    AND 	Z.PROCESS_AUTH_TYPE_CD = '01'
	                    AND		Z.PROCESS_AUTH_TARGET_ID = A.USR_ID
	                    AND		Z.PRJ_ID = #prjId#
					)
					 -->
				UNION
				SELECT
					'02' AS AUTH_TYPE_CD,
					A.LIC_GRP_ID,
					A.AUTH_GRP_ID AS USR_ID,
					A.AUTH_GRP_NM AS USR_NM,
					'' AS EMAIL,
					'' AS TELNO,
					'' AS USR_IMG_ID,
					'' AS DEPT_ID,
					'' AS DEPT_NM,
					'' AS USR_POSITION_CD,
					'' AS USR_DUTY_CD
				FROM PRJ2000 A
				WHERE 1=1
				AND A.LIC_GRP_ID = #licGrpId#
				AND A.PRJ_ID = #prjId#
				AND A.USE_CD = '01'
				<!-- 
				AND	NOT EXISTS
	       		(
					SELECT	Z.PROCESS_AUTH_TARGET_ID
					FROM	PRJ1106 Z
	                WHERE	1=1
	                AND 	Z.PROCESS_AUTH_TYPE_CD = '02'
	                AND		Z.PROCESS_AUTH_TARGET_ID = A.AUTH_GRP_ID
	                AND		Z.PRJ_ID = A.PRJ_ID
				)
				 -->
			) SUBT1
			WHERE 1=1
			<isNotEmpty property="prjAuthTypeCd">
             AND	SUBT1.AUTH_TYPE_CD = #prjAuthTypeCd#
            </isNotEmpty>
            <isNotEmpty property="paramSortFieldId">
				<isNotEmpty property="sortDirection">
					ORDER BY $paramSortFieldId$
					<isEqual property="sortDirection" compareValue="desc">
						DESC
					</isEqual>
				</isNotEmpty>
			</isNotEmpty>
			<isEmpty property="paramSortFieldId">
				ORDER BY DECODE(SUBT1.AUTH_TYPE_CD, '02', 1, '01', 2), SUBT1.USR_NM
			</isEmpty>
		) SUBT2
		WHERE 1=1
		<isNotEmpty property="searchTargetData">
			<isNotEmpty property="searchTargetId">
				<isEqual property="searchTargetId" compareValue="usrPositionCd">
					AND	SUBT2.USR_POSITION_CD = #searchTargetData#
				</isEqual>
				<isEqual property="searchTargetId" compareValue="usrDutyCd">
					AND	SUBT2.USR_DUTY_CD = #searchTargetData#
				</isEqual>
				<isEqual property="searchTargetId" compareValue="usrNm">
					AND	SUBT2.USR_NM LIKE '%'|| #searchTargetData# ||'%'
				</isEqual>
				<isEqual property="searchTargetId" compareValue="usrId">
					AND	SUBT2.USR_ID = #searchTargetData#
				</isEqual>
				<isEqual property="searchTargetId" compareValue="deptName">
					AND	SUBT2.DEPT_NAME LIKE '%'|| #searchTargetData# ||'%'
				</isEqual>
			</isNotEmpty>
		</isNotEmpty>
	</sql>
	
	
	<sql id="selectPrj1100FlowInfo">
		SELECT 
			A.PRJ_ID,					A.PROCESS_ID,			A.FLOW_ID,					A.FLOW_NM
			,A.FLOW_LEFT,				A.FLOW_TOP,				A.FLOW_DONE_CD
		    ,A.FLOW_ESSENTIAL_CD,		A.FLOW_SIGN_CD,			A.FLOW_SIGN_STOP_CD,		A.FLOW_END_CD
		    ,A.FLOW_WORK_CD,			A.FLOW_REVISION_CD,		A.FLOW_DPL_CD,				A.FLOW_AUTH_CD
		    ,A.FLOW_TITLE_BG_COLOR,		A.FLOW_TITLE_COLOR,		A.USE_CD
		    ,TO_CHAR(A.REG_DTM, 'YYYY-MM-DD HH24:MI:SS') AS REG_DTM
			,A.REG_USR_ID,				A.REG_USR_IP
			,TO_CHAR(A.MODIFY_DTM, 'YYYY-MM-DD HH24:MI:SS') AS MODIFY_DTM
			,A.MODIFY_USR_ID,			A.MODIFY_USR_IP
		FROM PRJ1101 A
	</sql>
	
	<select id="prj1100DAO.selectPrj1100ProcessListCnt" parameterClass="java.util.Map"  resultClass="java.lang.Integer">
	    
		SELECT
			COUNT(*) AS CNT
		FROM ( 
			<include refid="selectPrj1100List"/>
		) Z
    </select>
    
    
    <select id="prj1100DAO.selectPrj1100ProcessList" parameterClass="java.util.Map"  resultClass="egovMap">
	    
		SELECT 
			Z.*
		FROM ( 
			<include refid="selectPrj1100List"/>
		) Z
		WHERE 1 = 1
		AND Z.RN BETWEEN (#firstIndex#+1) AND #lastIndex#
    </select>
    
    
	<select id="prj1100DAO.selectPrj1100ProcessInfo" parameterClass="java.util.Map" resultClass="egovMap">
		
		SELECT T1.*
		FROM
		(
			<include refid="selectPrj1100List"/>
    	) T1
    	WHERE 1=1
		AND T1.PRJ_ID = #prjId#
		AND T1.PROCESS_ID = #processId#
	</select>
	
	
	<insert id="prj1100DAO.insertPrj1100ProcessInfo" parameterClass="java.util.Map">
		<selectKey resultClass="java.lang.String" keyProperty="newProcessId">
		<![CDATA[
			SELECT	NVL( 
							SUBSTR(NEW_PROCESS_ID, 1, 11) || LPAD( (TO_NUMBER(SUBSTR(NEW_PROCESS_ID, 12, 5)) + 1) , 5, '0')
						,	'PCS' || TO_CHAR(SYSDATE, 'YYYYMMDD') || '00001'
            		) AS NEW_PROCESS_ID 
			FROM	(
			            SELECT	MAX(PROCESS_ID)  AS NEW_PROCESS_ID
			            FROM	PRJ1100 A
			            WHERE	1=1
                        AND		A.PRJ_ID = #prjId#
			            AND		A.PROCESS_ID LIKE 'PCS' || TO_CHAR(SYSDATE, 'YYYYMMDD') || '%'
					)
		]]>
		</selectKey>
		
		<![CDATA[
			INSERT INTO PRJ1100
			(
				PRJ_ID,					PROCESS_ID
				,PROCESS_NM,			PROCESS_DESC
				,PROCESS_TRANSFER_CD,	PROCESS_DISABLED_CD
				,USE_CD,				DEL_CD,					PROCESS_ORD
				,REG_DTM,				REG_USR_ID,				REG_USR_IP
				,MODIFY_DTM,			MODIFY_USR_ID,			MODIFY_USR_IP
			)
			VALUES
			(
				#prjId#,				#newProcessId#
				,#processNm#,			#processDesc#
				,#processTransferCd#,	'02'
				,'01',					'02',					#processOrd#
				,SYSDATE,				#regUsrId#,				#regUsrIp#
				,SYSDATE,				#modifyUsrId#,			#modifyUsrId#
			)
		]]>
	</insert>
		
	
	<update id="prj1100DAO.updatePrj1100ProcessInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			UPDATE PRJ1100 A
			SET
		]]>
			A.MODIFY_DTM = SYSDATE
			,A.MODIFY_USR_ID = #modifyUsrId#
			,A.MODIFY_USR_IP = #modifyUsrIp#
			<isNotEmpty property="processNm">
				, A.PROCESS_NM = #processNm#
			</isNotEmpty>
			<isNotEmpty property="processDesc">
				, A.PROCESS_DESC = #processDesc#
			</isNotEmpty>
			<isNotEmpty property="processOrd">
				, A.PROCESS_ORD = #processOrd#
			</isNotEmpty>
			<isNotEmpty property="processTransferCd">
				, A.PROCESS_TRANSFER_CD = #processTransferCd#	
			</isNotEmpty>
			<isNotEmpty property="processDisabledCd">
				, A.PROCESS_DISABLED_CD = #processDisabledCd#
			</isNotEmpty>	
		<![CDATA[
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
		]]>
	</update>
	
	
	
	<select id="prj1100DAO.selectPrj1100ProcessAuthUsrList" parameterClass="java.util.Map" resultClass="egovMap">
		
		SELECT T1.*
		FROM
		(
			<include refid="selectPrj1100ProcessAuthUsrList"/>
    	) T1
    	WHERE 1=1
    	AND T1.RN BETWEEN (#firstIndex#+1) AND #lastIndex#
	</select>
	
	
	<select id="prj1100DAO.selectPrj1100ProcessAuthUsrListCnt" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		
		SELECT
			COUNT(*)
		FROM
		(
			<include refid="selectPrj1100ProcessAuthUsrList"/>
		) T1
	</select>
	
	
	<select id="prj1100DAO.selectPrj1100ProcessAuthNoneUsrList" parameterClass="java.util.Map" resultClass="egovMap">
		
		SELECT T1.*
		FROM
		(
			<include refid="selectPrj1100ProcessAuthNoneUsrList"/>
    	) T1
    	WHERE 1=1
    	AND T1.RN BETWEEN (#firstIndex#+1) AND #lastIndex#
	</select>
	
	
	<select id="prj1100DAO.selectPrj1100ProcessAuthNoneUsrListCnt" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		
		SELECT
			COUNT(*)
		FROM
		(
			<include refid="selectPrj1100ProcessAuthNoneUsrList"/>
		) T1
	</select>
	
	
	<insert id="prj1100DAO.insertPrj1100ProcessAuthInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			INSERT INTO PRJ1106
			(
                PRJ_ID,				PROCESS_ID,				PROCESS_AUTH_TYPE_CD,	PROCESS_AUTH_TARGET_ID	
            ,	REG_DTM,			REG_USR_ID,				REG_USR_IP
            ,	MODIFY_DTM,			MODIFY_USR_ID,			MODIFY_USR_IP
	        )VALUES(
	        	#prjId#,			#processId#,			#processAuthTypeCd#,	#processAuthTargetId#
	        	,SYSDATE,			#regUsrId#,				#regUsrIp#
	        	,SYSDATE,			#regUsrId#,				#regUsrIp#
	        )		
		]]>
	</insert>
	
	
	<delete id="prj1100DAO.deletePrj1100ProcessAuthInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			DELETE	
			FROM	PRJ1106 A
	        WHERE	1=1
	        AND		A.PRJ_ID		= #prjId#
	        AND		A.PROCESS_ID	= #processId#
		]]>
		<isNotEmpty property="processAuthTypeCd">
			AND A.PROCESS_AUTH_TYPE_CD = #processAuthTypeCd#
		</isNotEmpty>
		<isNotEmpty property="processAuthTargetId">
			AND A.PROCESS_AUTH_TARGET_ID = #processAuthTargetId#
		</isNotEmpty>
	</delete>
	
	
	<select id="prj1100DAO.selectPrj1101FlowInfo" parameterClass="java.util.Map" resultClass="egovMap">
		
		SELECT 
			SUBT1.*
		FROM ( 
			<include refid="selectPrj1100FlowInfo"/>
		) SUBT1
		WHERE 1=1
			AND SUBT1.PRJ_ID = #prjId#
		    AND SUBT1.PROCESS_ID = #processId#
			AND SUBT1.FLOW_ID = #flowId#
		    AND SUBT1.USE_CD = '01'
	</select>
	
	
	
	<select id="prj1100DAO.selectPrj1101FlowList" parameterClass="java.util.Map" resultClass="egovMap">
		
		SELECT 
			SUBT1.*
		FROM ( 
			<include refid="selectPrj1100FlowInfo"/>
		) SUBT1
		WHERE 1=1
			AND SUBT1.PRJ_ID = #prjId#
		    AND SUBT1.PROCESS_ID = #processId#
		    AND SUBT1.USE_CD = '01'
	</select>
	
	
	<insert id="prj1100DAO.insertPrj1101FlowInfo" parameterClass="java.util.Map">
		<selectKey resultClass="java.lang.String" keyProperty="newFlowId">
		<![CDATA[
			SELECT	NVL( 
							SUBSTR(NEW_FLOW_ID, 1, 11) || LPAD( (TO_NUMBER(SUBSTR(NEW_FLOW_ID, 12, 5)) + 1) , 5, '0')
						,	'FLW' || TO_CHAR(SYSDATE, 'YYYYMMDD') || '00001'
            		) AS NEW_FLOW_ID 
			FROM	(
			            SELECT	MAX(FLOW_ID)  AS NEW_FLOW_ID
			            FROM	PRJ1101 A
			            WHERE	1=1
                        AND		A.PRJ_ID = #prjId#
                        AND		A.PROCESS_ID = #processId#
			            AND		A.FLOW_ID LIKE 'FLW' || TO_CHAR(SYSDATE, 'YYYYMMDD') || '%'
					)
		]]>
		</selectKey>
		
		<![CDATA[
			INSERT INTO PRJ1101
			(
				PRJ_ID,					PROCESS_ID,					FLOW_ID
				,FLOW_NM,				FLOW_LEFT,					FLOW_TOP
				,FLOW_DONE_CD,			FLOW_ESSENTIAL_CD,			FLOW_SIGN_CD
				,FLOW_SIGN_STOP_CD,		FLOW_END_CD,				FLOW_WORK_CD
				,FLOW_REVISION_CD,		FLOW_DPL_CD,				FLOW_AUTH_CD	
				,FLOW_TITLE_BG_COLOR,	FLOW_TITLE_COLOR,			USE_CD
				,REG_DTM,				REG_USR_ID,					REG_USR_IP
			)
			VALUES
			(
				#prjId#,				#processId#,				#newFlowId#
				,#flowNm#,				NVL(#flowLeft#,20),			NVL(#flowTop#,20)
				,'02',					#flowEssentialCd#,			#flowSignCd#
				,#flowSignStopCd#,		#flowEndCd#,				#flowWorkCd#
				,#flowRevisionCd#,		#flowDplCd#,				#FlowAuthCd#
				,#flowTitleBgColor#,	#flowTitleColor#,			'01'
				,SYSDATE,				#regUsrId#,					#regUsrIp#
			)		
		]]>
	</insert>
	
	
	<select id="prj1100DAO.selectPrj1107FlowLinkList" parameterClass="java.util.Map" resultClass="egovMap">
		
		<![CDATA[
			SELECT 
				A.PRJ_ID,					A.PROCESS_ID,			A.FLOW_ID,					A.FLOW_NEXT_ID
			    ,TO_CHAR(A.REG_DTM, 'YYYY-MM-DD HH24:MI:SS') AS REG_DTM
				,A.REG_USR_ID,				A.REG_USR_IP
				,TO_CHAR(A.MODIFY_DTM, 'YYYY-MM-DD HH24:MI:SS') AS MODIFY_DTM
				,A.MODIFY_USR_ID,			A.MODIFY_USR_IP
			FROM PRJ1107 A
			WHERE 1=1
			    AND A.PRJ_ID = #prjId#
			    AND A.PROCESS_ID = #processId#
		]]>
			<isNotEmpty property="flowId">
				AND A.FLOW_ID = #flowId#			
			</isNotEmpty>
	</select>
	
	
	<insert id="prj1100DAO.insertPrj1100FlowNextIdInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			INSERT INTO PRJ1107
			(
                PRJ_ID,				PROCESS_ID,				FLOW_ID,		FLOW_NEXT_ID
            ,	REG_DTM,			REG_USR_ID,				REG_USR_IP
            ,	MODIFY_DTM,			MODIFY_USR_ID,			MODIFY_USR_IP
	        )VALUES(
	        	#prjId#,			#processId#,			#flowId#,		#flowNextId#
	        	,SYSDATE,			#regUsrId#,				#regUsrIp#
	        	,SYSDATE,			#regUsrId#,				#regUsrIp#
	        )		
		]]>
	</insert> 
	
	
	<delete id="prj1100DAO.deletePrj1100FlowNextIdList" parameterClass="java.util.Map">
		
		<![CDATA[
			DELETE FROM PRJ1107 A
			WHERE 1=1
				AND		A.PRJ_ID = #prjId#
				AND		A.PROCESS_ID = #processId#
		]]>
	</delete>
	
	
	<update id="prj1100DAO.updatePrj1101FlowInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			UPDATE PRJ1101 A
			SET
		]]>
				A.FLOW_NM = #flowNm#
				<isNotEmpty property="flowLeft">
					,A.FLOW_LEFT = #flowLeft#
				</isNotEmpty>
				<isNotEmpty property="flowTop">
					,A.FLOW_TOP = #flowTop#
				</isNotEmpty>
				<isNotEmpty property="flowDoneCd">
					,A.FLOW_DONE_CD = #flowDoneCd#
				</isNotEmpty>
				,A.FLOW_ESSENTIAL_CD = #flowEssentialCd#
				,A.FLOW_SIGN_CD = #flowSignCd#
				,A.FLOW_SIGN_STOP_CD = #flowSignStopCd#
				,A.FLOW_END_CD = #flowEndCd#
				,A.FLOW_WORK_CD = #flowWorkCd#
				,A.FLOW_REVISION_CD = #flowRevisionCd#
				,A.FLOW_DPL_CD = #flowDplCd#
				,A.FLOW_AUTH_CD = #flowAuthCd#
				,A.FLOW_TITLE_BG_COLOR = #flowTitleBgColor#
				,A.FLOW_TITLE_COLOR = #flowTitleColor#
				,A.MODIFY_DTM = SYSDATE
				,A.MODIFY_USR_ID = #modifyUsrId#
				,A.MODIFY_USR_IP = #modifyUsrIp#
		<![CDATA[
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
			AND A.FLOW_ID = #flowId#
		]]>
	</update>
	
	
	<select id="prj1100DAO.selectPrj1100FlowReqListCnt" parameterClass="java.util.Map"  resultClass="java.lang.Integer">
	    
		SELECT COUNT(*) AS CNT
		FROM REQ4100 A
		WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
			AND A.FLOW_ID = #flowId#
			AND A.USE_CD = '01'
    </select>
    
	
	<update id="prj1100DAO.deletePrj1101FlowInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			UPDATE PRJ1101 A
			SET
				USE_CD = '02'
				,A.MODIFY_DTM = SYSDATE
				,A.MODIFY_USR_ID = #modifyUsrId#
				,A.MODIFY_USR_IP = #modifyUsrIp#
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
		]]>
			<isNotEmpty property="flowId">
				AND A.FLOW_ID = #flowId#
			</isNotEmpty>
	</update>
	
	
	<sql id="prj1100DAO.selectPrj1104ReqRevisionNumList">
		<![CDATA[
			SELECT 
				A.PRJ_ID,				A.REQ_ID,				A.PROCESS_ID,			A.FLOW_ID
				,A.SVN_REP_ID,			B.SVN_REP_NM,			B.SVN_REP_URL,			C.FLOW_NM
				,A.REVISION_NUM,		A.REVISION_COMMENT
				,TO_CHAR(A.REG_DTM, 'YYYY-MM-DD HH24:MI') AS REG_DTM
				,A.REG_USR_ID,			A.REG_USR_IP
				,TO_CHAR(A.MODIFY_DTM, 'YYYY-MM-DD HH24:MI') AS MODIFY_DTM
				,A.MODIFY_USR_ID,		A.MODIFY_USR_IP
			FROM PRJ1104 A, STM8000 B, PRJ1101 C
			WHERE 1=1
			AND A.SVN_REP_ID = B.SVN_REP_ID
            AND B.LIC_GRP_ID = #licGrpId#
			AND	A.PRJ_ID = #prjId#
			AND	A.REQ_ID = #reqId#
			AND	A.PROCESS_ID = #processId#
			AND A.PRJ_ID = C.PRJ_ID
			AND A.PROCESS_ID = C.PROCESS_ID
			AND A.FLOW_ID = C.FLOW_ID
		]]>
			<isNotEmpty property="flowId">
				AND A.FLOW_ID = #flowId#
			</isNotEmpty>
		<![CDATA[
			AND B.USE_CD = '01'
			ORDER BY B.SVN_REP_ID, A.REVISION_NUM DESC
		]]>
	</sql>
	
	
	<update id="prj1100DAO.deletePrj1100ProcessInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			UPDATE PRJ1100 A
			SET
				DEL_CD = '01'
				,A.MODIFY_DTM = SYSDATE
				,A.MODIFY_USR_ID = #modifyUsrId#
				,A.MODIFY_USR_IP = #modifyUsrIp#
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
		]]>
	</update>
	
	
	<select id="prj1100DAO.selectPrj1100ProcessReqCnt" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		
		<![CDATA[
			SELECT COUNT(*) AS REQ_CNT
			FROM REQ4100 A
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
		]]>	
	</select>
	
	
	<select id="prj1100DAO.selectPrj1102ReqOptList"  parameterClass="java.util.Map" resultClass="egovMap">
		
		<![CDATA[
			SELECT
				A.PRJ_ID,				A.PROCESS_ID,			A.FLOW_ID,					A.ITEM_ID
				,B.ITEM_VALUE
				,NVL((
                	CASE A.ITEM_CODE WHEN '04' THEN SF_STM3000_USR_INFO(B.ITEM_VALUE,'1')
                	 WHEN '05' THEN (SELECT	REQ_CLS_NM FROM REQ2000 WHERE 1=1 AND PRJ_ID = A.PRJ_ID AND REQ_CLS_ID = B.ITEM_VALUE)
                	 WHEN '06' THEN SF_STM6000_DEPT_NM(#licGrpId#, B.ITEM_VALUE, '2')
                    ELSE NULL END
                ),' ') AS ITEM_VALUE_NM
				,B.REG_DTM AS VALUE_IN_DTM
				,A.ITEM_NM,				A.ITEM_CODE,			A.ITEM_COMMON_CODE,			A.ITEM_ROW_NUM
				,A.ITEM_TYPE,			A.ITEM_LENGTH,			A.ITEM_ESSENTIAL_CD,		A.ITEM_MODIFY_CD
				,A.ITEM_SD_CD,			A.ITEM_ORD,			A.USE_CD
				,SF_STM4001_COM_CD_INFO(#licGrpId#, 'FLW00001', A.ITEM_CODE, '1') AS ITEM_CODE_STR
				,SF_STM4001_COM_CD_INFO(#licGrpId#, 'FLW00003', A.ITEM_TYPE, '1') AS ITEM_TYPE_STR
				,SF_STM4001_COM_CD_INFO(#licGrpId#, 'FLW00002', A.ITEM_ROW_NUM, '1') AS ITEM_ROW_NUM_STR
				,SF_STM2000_MST_CD_NM(#licGrpId#, A.ITEM_COMMON_CODE) AS ITEM_COMMON_CODE_STR
				,TO_CHAR(A.REG_DTM, 'YYYY-MM-DD HH24:MI:SS') AS REG_DTM
				,A.REG_USR_ID,			A.REG_USR_IP
			FROM PRJ1102 A, PRJ1103 B, REQ6001 C
			WHERE 1=1
            AND A.PRJ_ID = B.PRJ_ID(+)
            AND A.PROCESS_ID = B.PROCESS_ID(+)
            AND A.FLOW_ID = B.FLOW_ID(+)
            AND A.ITEM_ID = B.ITEM_ID(+)
            AND B.REQ_ID(+) = #reqId#
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
            AND C.PRJ_ID = A.PRJ_ID
            AND C.PROCESS_ID = A.PROCESS_ID
            AND C.REQ_ID = #reqId#
            AND A.FLOW_ID = C.CHG_FLOW_ID(+)
			AND A.USE_CD = '01'
			AND C.REQ_CHG_TYPE != '02'
			ORDER BY C.CHG_DTM, A.ITEM_ORD
		]]>
	</select>
	
	
	<select id="prj1100DAO.selectPrj1102OptList"  parameterClass="java.util.Map" resultClass="egovMap">
		
		<![CDATA[
			SELECT
				A.PRJ_ID,				A.PROCESS_ID,			A.FLOW_ID,					A.ITEM_ID
				,B.ITEM_VALUE,			B.REG_DTM AS VALUE_IN_DTM
				,A.ITEM_NM,				A.ITEM_CODE,			A.ITEM_COMMON_CODE,			A.ITEM_ROW_NUM
				,A.ITEM_TYPE,			A.ITEM_LENGTH,			A.ITEM_ESSENTIAL_CD,		A.ITEM_MODIFY_CD
				,A.ITEM_SD_CD,			A.ITEM_ORD,			A.USE_CD
				,SF_STM4001_COM_CD_INFO(#licGrpId#, 'FLW00001', A.ITEM_CODE, '1') AS ITEM_CODE_STR
				,SF_STM4001_COM_CD_INFO(#licGrpId#, 'FLW00003', A.ITEM_TYPE, '1') AS ITEM_TYPE_STR
				,SF_STM4001_COM_CD_INFO(#licGrpId#, 'FLW00002', A.ITEM_ROW_NUM, '1') AS ITEM_ROW_NUM_STR
				,SF_STM2000_MST_CD_NM(#licGrpId#, A.ITEM_COMMON_CODE) AS ITEM_COMMON_CODE_STR
				,TO_CHAR(A.REG_DTM, 'YYYY-MM-DD HH24:MI:SS') AS REG_DTM
				,A.REG_USR_ID,			A.REG_USR_IP
			FROM PRJ1102 A, PRJ1103 B
			WHERE 1=1
            AND A.PRJ_ID = B.PRJ_ID(+)
            AND A.PROCESS_ID = B.PROCESS_ID(+)
            AND A.ITEM_ID = B.ITEM_ID(+)
            AND B.REQ_ID(+) = #reqId#
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
		]]>
			<isNotEmpty property="flowId">
				AND A.FLOW_ID = #flowId#
			</isNotEmpty>
		<![CDATA[	
			AND A.USE_CD = '01'
			ORDER BY A.ITEM_ORD, A.REG_DTM DESC
		]]>
	</select>
	
	
	<select id="prj1100DAO.selectPrj1103OptFileList"  parameterClass="java.util.Map" resultClass="egovMap">
		
		<![CDATA[
			SELECT
				C.ORIGNL_FILE_NM AS FILE_NAME
				,C.FILE_SIZE
				,C.REG_DTM
			FROM PRJ1102 A
			LEFT OUTER JOIN PRJ1103 B
			ON ( A.PRJ_ID = B.PRJ_ID AND A.PROCESS_ID = B.PROCESS_ID AND A.ITEM_ID = B.ITEM_ID AND B.REQ_ID = #reqId#)
			INNER JOIN COMTNFILEDETAIL C
			ON ( C.ATCH_FILE_ID = B.ITEM_VALUE )
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
			AND A.USE_CD = '01'
			AND A.ITEM_CODE = '03'
			ORDER BY A.ITEM_ORD, C.FILE_SN
		]]>
	</select>
	
	
	<select id="prj1100DAO.selectPrj1102OptCntInfo"  parameterClass="java.util.Map" resultClass="java.lang.Integer">
		
		<![CDATA[
			SELECT COUNT(*) AS CNT
			FROM PRJ1103 A
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId# 
			AND A.FLOW_ID =  #flowId#
			AND A.REQ_ID =  #reqId#
			AND A.ITEM_ID =  #itemId#
		]]>
	</select>
	
	
	<insert id="prj1100DAO.insertPrj1102OtpInfo" parameterClass="java.util.Map">
		<selectKey resultClass="java.lang.String" keyProperty="newItemId">
		<![CDATA[
			SELECT	NVL( 
							SUBSTR(NEW_ITEM_ID, 1, 11) || LPAD( (TO_NUMBER(SUBSTR(NEW_ITEM_ID, 12, 5)) + 1) , 5, '0')
						,	'OPT' || TO_CHAR(SYSDATE, 'YYYYMMDD') || '00001'
            		) AS NEW_ITEM_ID 
			FROM	(
			            SELECT	MAX(ITEM_ID)  AS NEW_ITEM_ID
			            FROM	PRJ1102 A
			            WHERE	1=1
                        AND		A.PRJ_ID = #prjId#
                        AND		A.PROCESS_ID = #processId#
			            AND		A.ITEM_ID LIKE 'OPT' || TO_CHAR(SYSDATE, 'YYYYMMDD') || '%'
					)
		]]>
		</selectKey>
		
		<![CDATA[
			INSERT INTO PRJ1102 A
			(
				A.PRJ_ID,				A.PROCESS_ID,				A.FLOW_ID,					A.ITEM_ID
				,A.ITEM_NM,				A.ITEM_CODE,				A.ITEM_COMMON_CODE,			A.ITEM_ROW_NUM
				,A.ITEM_TYPE,			A.ITEM_LENGTH,				A.ITEM_ESSENTIAL_CD,		A.ITEM_MODIFY_CD
				,A.ITEM_SD_CD,			A.ITEM_ORD					,A.USE_CD
				,A.REG_DTM,				A.REG_USR_ID,				A.REG_USR_IP
				,A.MODIFY_DTM,			A.MODIFY_USR_ID,			A.MODIFY_USR_IP
			)
			VALUES
			(
				#prjId#,				#processId#,				#flowId#,					#newItemId#
				,#itemNm#,				#itemCode#,					#itemCommonCode#,			#itemRowNum#
				,#itemType#,			NVL(#itemLength#,255),		#itemEssentialCd#,			#itemModifyCd#
				,#itemSdCd#,			NVL(#itemOrd#,0)			,'01'
				,SYSDATE,				#regUsrId#,					#regUsrIp#
				,SYSDATE,				#modifyUsrId#,				#modifyUsrIp#
			)		
		
		]]>
	</insert>
	
	
	<insert id="prj1100DAO.insertPrj1102OtpCopyInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			INSERT INTO PRJ1102 A
			(
				A.PRJ_ID,				A.PROCESS_ID,				A.FLOW_ID,					A.ITEM_ID
				,A.ITEM_NM,				A.ITEM_CODE,				A.ITEM_COMMON_CODE,			A.ITEM_ROW_NUM
				,A.ITEM_TYPE,			A.ITEM_LENGTH,				A.ITEM_ESSENTIAL_CD,		A.ITEM_MODIFY_CD
				,A.ITEM_SD_CD,			A.ITEM_ORD					,A.USE_CD
				,A.REG_DTM,				A.REG_USR_ID,				A.REG_USR_IP
				,A.MODIFY_DTM,			A.MODIFY_USR_ID,			A.MODIFY_USR_IP
			)
			VALUES
			(
				#prjId#,				#processId#,				#flowId#,					#itemId#
				,#itemNm#,				#itemCode#,					#itemCommonCode#,			#itemRowNum#
				,#itemType#,			NVL(#itemLength#,255),		#itemEssentialCd#,			#itemModifyCd#
				,#itemSdCd#,			NVL(#itemOrd#,0)			,'01'
				,SYSDATE,				#regUsrId#,					#regUsrIp#
				,SYSDATE,				#modifyUsrId#,				#modifyUsrIp#
			)		
		
		]]>
	</insert>
	
	
	<update id="prj1100DAO.updatePrj1102OtpInfo" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE PRJ1102 A
			SET
				ITEM_NM					=	#itemNm#
				,ITEM_CODE				=	#itemCode#
				,ITEM_COMMON_CODE		=	#itemCommonCode#
				,ITEM_ROW_NUM			=	#itemRowNum#
				,ITEM_TYPE				=	#itemType#
				,ITEM_LENGTH			=	#itemLength#
				,ITEM_ESSENTIAL_CD		=	#itemEssentialCd#
				,ITEM_MODIFY_CD			=	#itemModifyCd#
				,ITEM_SD_CD				=	#itemSdCd#
				,ITEM_ORD				=	#itemOrd#
				,A.MODIFY_DTM 			= 	SYSDATE
				,A.MODIFY_USR_ID 		= 	#modifyUsrId#
				,A.MODIFY_USR_IP 		= 	#modifyUsrIp#
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
			AND A.FLOW_ID = #flowId#
			AND	A.ITEM_ID = #itemId#
		]]>
	</update>
	
	
	<update id="prj1100DAO.deletePrj1102OtpInfo" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE PRJ1102 A
			SET
				USE_CD					=	'02'
				,A.MODIFY_DTM 			= 	SYSDATE
				,A.MODIFY_USR_ID 		= 	#modifyUsrId#
				,A.MODIFY_USR_IP 		= 	#modifyUsrIp#
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
		]]>
		<isNotEmpty property="flowId">
			AND A.FLOW_ID = #flowId#
		</isNotEmpty>
		<isNotEmpty property="itemId">
			AND	A.ITEM_ID = #itemId#
		</isNotEmpty>
	</update>
	
	
	<insert id="prj1100DAO.insertPrj1103OtpValueInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			INSERT INTO PRJ1103 A
			(
				A.PRJ_ID,				A.PROCESS_ID,				A.FLOW_ID,					A.REQ_ID					
				,A.ITEM_ID,				A.ITEM_VALUE
				,A.REG_DTM,				A.REG_USR_ID,				A.REG_USR_IP
				,A.MODIFY_DTM,			A.MODIFY_USR_ID,			A.MODIFY_USR_IP
			)
			VALUES
			(
				#prjId#,				#processId#,				#flowId#,					#reqId#
				,#itemId#,				#itemValue#
				,SYSDATE,				#regUsrId#,					#regUsrIp#
				,SYSDATE,				#modifyUsrId#,				#modifyUsrIp#
			)		
		
		]]>
	</insert>
	
	
	<update id="prj1100DAO.updatePrj1103OtpValueInfo" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE PRJ1103 A
			SET
				ITEM_VALUE				=	#itemValue#
				,A.MODIFY_DTM 			= 	SYSDATE
				,A.MODIFY_USR_ID 		= 	#modifyUsrId#
				,A.MODIFY_USR_IP 		= 	#modifyUsrIp#
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.PROCESS_ID = #processId#
			AND A.FLOW_ID = #flowId#
			AND A.REQ_ID = #reqId#
			AND	A.ITEM_ID = #itemId#
		]]>
	</update>
	
	
	<insert id="prj1100DAO.insertPrj1104RevisionNumInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			INSERT INTO PRJ1104 A
			(
				A.PRJ_ID,				A.REQ_ID,					A.PROCESS_ID,				A.FLOW_ID
				,A.SVN_REP_ID,			A.REVISION_NUM,				A.REVISION_COMMENT				
				,A.REG_DTM,				A.REG_USR_ID,				A.REG_USR_IP
				,A.MODIFY_DTM,			A.MODIFY_USR_ID,			A.MODIFY_USR_IP
			)
			VALUES
			(
				#prjId#,				#reqId#,					#processId#,				#flowId#
				,#svnRepId#,			#revisionNum#,				#revisionComment#
				,SYSDATE,				#regUsrId#,					#regUsrIp#
				,SYSDATE,				#modifyUsrId#,				#modifyUsrIp#
			)		
		
		]]>
	</insert>
	
	
	<delete id="prj1100DAO.deletePrj1103RevisionNumInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			DELETE FROM PRJ1104 A
			WHERE 1=1
				AND		A.PRJ_ID = #prjId#
				AND		A.REQ_ID = #reqId#
				AND		A.PROCESS_ID = #processId#
				AND		A.FLOW_ID = #flowId#
				AND		A.SVN_REP_ID = #svnRepId#
				AND		A.REVISION_NUM = #revisionNum#
		]]>
	</delete>

	 
	<select id="prj1100DAO.selectPrj1104ReqRevisionNumList"  parameterClass="java.util.Map" resultClass="egovMap">
		
		SELECT *
		FROM
			(
	    		SELECT ROWNUM RN,
	    			     T.*
	    		FROM
	    		(
					<include refid="prj1100DAO.selectPrj1104ReqRevisionNumList"/>
	    		) T
	    	)
	    	 WHERE RN BETWEEN (#firstIndex#+1) AND #lastIndex#
	</select>
	
	 
    <select id="prj1100DAO.selectPrj1104ReqRevisionNumListCnt" parameterClass="java.util.Map"  resultClass="java.lang.Integer">
	    
	    SELECT
				COUNT(*)
		FROM(
				<include refid="prj1100DAO.selectPrj1104ReqRevisionNumList"/>
		) T1
    </select>
	
	
	
	<select id="prj1100DAO.selectPrj1104ReqRevisionNumCnt"  parameterClass="java.util.Map" resultClass="java.lang.Integer">
		
		<![CDATA[
			SELECT COUNT(*) AS REP_CNT
			FROM PRJ1104 A, STM8000 B
			WHERE 1=1
			AND A.SVN_REP_ID = B.SVN_REP_ID
            AND B.LIC_GRP_ID = #licGrpId#
			AND	A.PRJ_ID = #prjId#
			AND	A.REQ_ID = #reqId#
			AND	A.PROCESS_ID = #processId#
			AND A.FLOW_ID = #flowId#
			AND A.SVN_REP_ID = #svnRepId#
			AND A.REVISION_NUM = #revisionNum#
			AND B.USE_CD = '01'
		]]>
	</select>
	
	
	<insert id="prj1100DAO.insertPrj1105FlowAuthGrpInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			INSERT INTO PRJ1105 A
			(
				A.PRJ_ID,				A.PROCESS_ID,				A.FLOW_ID
				,A.AUTH_GRP_ID,			A.AUTH_GRP_TARGET_CD		
				,A.REG_DTM,				A.REG_USR_ID,				A.REG_USR_IP
				,A.MODIFY_DTM,			A.MODIFY_USR_ID,			A.MODIFY_USR_IP
			)
			VALUES
			(
				#prjId#,				#processId#,				#flowId#
				,#authGrpId#,			#authGrpTargetCd#
				,SYSDATE,				#regUsrId#,					#regUsrIp#
				,SYSDATE,				#modifyUsrId#,				#modifyUsrIp#
			)		
		
		]]>
	</insert>
	
	
	<delete id="prj1100DAO.deletePrj1105FlowAuthGrpInfo" parameterClass="java.util.Map">
		
		<![CDATA[
			DELETE FROM PRJ1105 A
			WHERE 1=1
				AND		A.PRJ_ID = #prjId#
				AND		A.PROCESS_ID = #processId#
				AND		A.FLOW_ID = #flowId#
				AND		A.AUTH_GRP_ID = #authGrpId#
				AND		A.AUTH_GRP_TARGET_CD = #authGrpTargetCd#
		]]>
	</delete>
	
	
	<select id="prj1100DAO.selectPrj1105FlowAuthGrpList"  parameterClass="java.util.Map" resultClass="egovMap">
		
		<![CDATA[
			SELECT 
				A.PRJ_ID, A.PROCESS_ID, A.FLOW_ID, A.AUTH_GRP_ID, A.AUTH_GRP_TARGET_CD
			    ,B.AUTH_GRP_NM
			    ,B.AUTH_GRP_DESC
			    ,B.CREATE_DT
			    ,B.USE_CD
			    ,B.USR_TYP
			    ,SF_STM4001_COM_CD_INFO(#licGrpId#, 'ADM00004', B.USR_TYP, '1') AS USR_TYP_NM
			FROM PRJ1105 A, PRJ2000 B
			WHERE 1=1
			AND B.LIC_GRP_ID = #licGrpId#
			AND	A.PRJ_ID = #prjId#
			AND	A.PROCESS_ID = #processId#
		]]>
			<isNotEmpty property="flowId">
				AND A.FLOW_ID = #flowId#
			</isNotEmpty>
			<isNotEmpty property="authGrpTargetCd">
				AND A.AUTH_GRP_TARGET_CD = #authGrpTargetCd#
			</isNotEmpty>
		<![CDATA[
			AND A.PRJ_ID = B.PRJ_ID
			AND A.AUTH_GRP_ID = B.AUTH_GRP_ID
			AND B.USE_CD = '01'
			ORDER BY B.ORD
		]]>
	</select>
	
	
	<select id="prj1100DAO.selectPrj1105FlowAuthGrpCnt"  parameterClass="java.util.Map" resultClass="java.lang.Integer">
		
		<![CDATA[
			SELECT COUNT(*) AS AUTH_GRP_CNT
			FROM PRJ1105 A
			WHERE 1=1
			AND	A.PRJ_ID = #prjId#
			AND	A.PROCESS_ID = #processId#
			AND A.FLOW_ID = #flowId#
			AND A.AUTH_GRP_ID = #authGrpId#
			AND A.AUTH_GRP_TARGET_CD = #authGrpTargetCd#
		]]>
	</select>
	
	
	<select id="prj1100DAO.selectPrj1100ProcessCopyList"  parameterClass="java.util.Map" resultClass="egovMap">
		
		<![CDATA[
			SELECT
				B.PRJ_ID,					C.PRJ_NM
				,B.PROCESS_ID,				B.PROCESS_NM
				,B.PROCESS_DESC
				,B.PROCESS_CONFIRM_CD
				,B.PROCESS_MIDDLE_DONE_CD
				,B.PROCESS_JSON_DATA
				,B.USE_CD
				,B.PROCESS_ORD
				,TO_CHAR(B.REG_DTM, 'YYYY-MM-DD HH24:MI:SS') AS REG_DTM
				,B.REG_USR_ID,				B.REG_USR_IP
				,TO_CHAR(B.MODIFY_DTM, 'YYYY-MM-DD HH24:MI:SS') AS MODIFY_DTM
				,B.MODIFY_USR_ID,			B.MODIFY_USR_IP
			FROM
			(
				SELECT DISTINCT Z.PRJ_ID
				FROM PRJ2000 Z, PRJ2001 X
				WHERE 1=1
				AND Z.PRJ_ID = X.PRJ_ID
				AND Z.AUTH_GRP_ID = X.AUTH_GRP_ID
				AND Z.USR_TYP = '02'
				AND Z.LIC_GRP_ID = #licGrpId#
		]]>
		 		<isNotEqual property="selectType" compareValue="systemAdmin">
			    	AND USR_ID = #usrId#
			   </isNotEqual>
		<![CDATA[	    					
			) A, PRJ1100 B, PRJ1000 C
			WHERE 1=1
			AND A.PRJ_ID = B.PRJ_ID
			AND A.PRJ_ID = C.PRJ_ID
			AND B.USE_CD = '01'
			AND B.PROCESS_CONFIRM_CD = '02'
			ORDER BY B.PRJ_ID, B.PROCESS_ORD
		]]>
	</select>
	
	
	<select id="prj1100DAO.selectPrj1102FlwOptExistFileIdList"  parameterClass="java.util.Map" resultClass="egovMap">
		
		<![CDATA[
			SELECT A.*
			FROM PRJ1103 A, PRJ1102 B
			WHERE 1=1
			AND A.PRJ_ID = #prjId#
			AND A.ITEM_VALUE IS NOT NULL
			AND A.PRJ_ID = B.PRJ_ID
			AND A.PROCESS_ID = B.PROCESS_ID
			AND A.ITEM_ID = B.ITEM_ID
			AND B.ITEM_CODE = '03'
		]]>
	</select>
</sqlMap>